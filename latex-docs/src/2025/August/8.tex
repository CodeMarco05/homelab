\subsection{8. August 2025 - K3s Cluster Setup}

Dieser Abschnitt dokumentiert die Implementierung eines K3s Clusters. K3s ist eine leichtgewichtige Kubernetes-Distribution, die sich optimal für Homelab-Umgebungen und Edge-Computing-Szenarien eignet.

\subsubsection{Systemvorbereitung}

Zunächst werden alle Pakete auf dem Zielsystem aktualisiert:

\begin{verbatim}
sudo apt update && sudo apt upgrade -y
\end{verbatim}

\subsubsection{OpenSSH Server Installation}

Für die Remote-Verwaltung der Cluster-Nodes wird der OpenSSH Server installiert:

\begin{verbatim}
sudo apt install openssh-server -y
sudo systemctl enable ssh
sudo systemctl start ssh
\end{verbatim}

Die SSH-Konfiguration wird für Key-basierte Authentifizierung angepasst, um die Sicherheit zu erhöhen:

\begin{verbatim}
sudo nano /etc/ssh/sshd_config
# PasswordAuthentication no
# PubkeyAuthentication yes
sudo systemctl restart ssh
\end{verbatim}

\subsubsection{Tailscale-Netzwerk-Integration}

Zur Etablierung einer sicheren Mesh-Netzwerk-Verbindung zwischen den Nodes wird Tailscale implementiert:

\begin{verbatim}
curl -fsSL https://tailscale.com/install.sh | sh
sudo tailscale up
\end{verbatim}

Nach der Installation wird ein Authentifizierungslink generiert, welcher in einem Webbrowser aufgerufen werden muss.

\subsubsection{Master Node Deployment}

Der K3s Master Node (Control Plane) wird mit folgender Konfiguration bereitgestellt:

\begin{verbatim}
curl -sfL https://get.k3s.io | sh -s - server \
  --node-ip=100.93.96.107
\end{verbatim}

Nach erfolgreicher Installation wird das Node Token extrahiert:

\begin{verbatim}
sudo cat /var/lib/rancher/k3s/server/node-token
\end{verbatim}

\subsubsection{Worker Node Integration}

Die Worker Nodes werden mittels folgendem Befehl dem bestehenden Cluster hinzugefügt:

\begin{verbatim}
curl -sfL https://get.k3s.io | \
  K3S_URL=https://<master-node-ip>:6443 \
  K3S_TOKEN=<TOKEN> \
  sh -s - agent --node-ip=<worker-tailscale-ip>
\end{verbatim}

Der Platzhalter \texttt{<TOKEN>} wird durch das zuvor extrahierte Node Token ersetzt.

\subsubsection{CLI-Tools und Verwaltungsoptimierung}

Zur Verbesserung der Benutzerfreundlichkeit wird ein Alias für kubectl konfiguriert:

\begin{verbatim}
echo 'alias k=kubectl' >> ~/.bashrc
source ~/.bashrc
\end{verbatim}

Zusätzlich wird k9s als Terminal-basierte Cluster-Verwaltungsschnittstelle installiert:

\begin{verbatim}
brew install k9s
\end{verbatim}

Die Kubernetes-Konfiguration wird für den aktuellen Benutzer verfügbar gemacht:

\begin{verbatim}
mkdir ~/.kube
sudo cp /etc/rancher/k3s/k3s.yaml ~/.kube/config
sudo chown $USER:$USER ~/.kube/config
\end{verbatim}

Die Cluster-Verwaltung kann nun über die \texttt{k9s} Terminal-UI erfolgen.

Der K3s Cluster ist erfolgreich implementiert und betriebsbereit für nachfolgende Workload-Deployments.